Namespace(batch_size=128, dropout=0.5, embed_dim=256, embedding='TensorTrain', eta=1.0, hidden_dim=128, kl_multiplier=0.001, lr=0.0005, n_epochs=100, no_kl_epochs=20, prior_type='log_uniform', rank=20, rank_loss=True, voc_dim=25000, warmup_epochs=50)
Building dataset...
Done
Sequential(
  (0): TensorizedEmbedding(
    (tensor): TensorTrain(
      (trainable_variables): ParameterList(
          (0): Parameter containing: [torch.cuda.FloatTensor of size 1x5x20 (GPU 0)]
          (1): Parameter containing: [torch.cuda.FloatTensor of size 20x8x20 (GPU 0)]
          (2): Parameter containing: [torch.cuda.FloatTensor of size 20x25x20 (GPU 0)]
          (3): Parameter containing: [torch.cuda.FloatTensor of size 20x25x20 (GPU 0)]
          (4): Parameter containing: [torch.cuda.FloatTensor of size 20x4x20 (GPU 0)]
          (5): Parameter containing: [torch.cuda.FloatTensor of size 20x8x20 (GPU 0)]
          (6): Parameter containing: [torch.cuda.FloatTensor of size 20x8x1 (GPU 0)]
          (7): Parameter containing: [torch.cuda.FloatTensor of size 1x5x20 (GPU 0)]
          (8): Parameter containing: [torch.cuda.FloatTensor of size 20x8x20 (GPU 0)]
          (9): Parameter containing: [torch.cuda.FloatTensor of size 20x25x20 (GPU 0)]
          (10): Parameter containing: [torch.cuda.FloatTensor of size 20x25x20 (GPU 0)]
          (11): Parameter containing: [torch.cuda.FloatTensor of size 20x4x20 (GPU 0)]
          (12): Parameter containing: [torch.cuda.FloatTensor of size 20x8x20 (GPU 0)]
          (13): Parameter containing: [torch.cuda.FloatTensor of size 20x8x1 (GPU 0)]
          (14): Parameter containing: [torch.cuda.FloatTensor of size 20 (GPU 0)]
          (15): Parameter containing: [torch.cuda.FloatTensor of size 20 (GPU 0)]
          (16): Parameter containing: [torch.cuda.FloatTensor of size 20 (GPU 0)]
          (17): Parameter containing: [torch.cuda.FloatTensor of size 20 (GPU 0)]
          (18): Parameter containing: [torch.cuda.FloatTensor of size 20 (GPU 0)]
          (19): Parameter containing: [torch.cuda.FloatTensor of size 20 (GPU 0)]
      )
    )
  )
  (1): LSTM_Classifier(
    (rnn): LSTM(256, 128, num_layers=2, dropout=0.5, bidirectional=True)
    (fc): Linear(in_features=256, out_features=1, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
)
| Epoch: 01 | Train Loss: 0.688 | Train Acc: 52.55% | Val. Loss: 0.676 | Val. Acc: 61.30% | Test Loss: 0.680 | Test Acc: 60.50% |
TEST ACCURACY: 60.5
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 02 | Train Loss: 0.602 | Train Acc: 67.76% | Val. Loss: 0.537 | Val. Acc: 74.73% | Test Loss: 0.542 | Test Acc: 73.96% |
TEST ACCURACY: 73.96
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 03 | Train Loss: 0.530 | Train Acc: 74.94% | Val. Loss: 0.527 | Val. Acc: 73.94% | Test Loss: 0.531 | Test Acc: 73.94% |
TEST ACCURACY: 73.96
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 04 | Train Loss: 0.557 | Train Acc: 72.08% | Val. Loss: 0.598 | Val. Acc: 75.81% | Test Loss: 0.599 | Test Acc: 75.42% |
TEST ACCURACY: 75.42
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 05 | Train Loss: 0.487 | Train Acc: 78.26% | Val. Loss: 0.501 | Val. Acc: 74.95% | Test Loss: 0.509 | Test Acc: 74.06% |
TEST ACCURACY: 75.42
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 06 | Train Loss: 0.435 | Train Acc: 80.83% | Val. Loss: 0.417 | Val. Acc: 81.61% | Test Loss: 0.425 | Test Acc: 81.03% |
TEST ACCURACY: 81.03
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 07 | Train Loss: 0.392 | Train Acc: 82.95% | Val. Loss: 0.382 | Val. Acc: 83.37% | Test Loss: 0.396 | Test Acc: 82.73% |
TEST ACCURACY: 82.73
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 08 | Train Loss: 0.384 | Train Acc: 83.73% | Val. Loss: 0.390 | Val. Acc: 82.43% | Test Loss: 0.401 | Test Acc: 82.09% |
TEST ACCURACY: 82.73
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 09 | Train Loss: 0.361 | Train Acc: 85.11% | Val. Loss: 0.369 | Val. Acc: 83.80% | Test Loss: 0.382 | Test Acc: 83.54% |
TEST ACCURACY: 83.54
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 10 | Train Loss: 0.345 | Train Acc: 85.60% | Val. Loss: 0.357 | Val. Acc: 84.29% | Test Loss: 0.370 | Test Acc: 83.67% |
TEST ACCURACY: 83.67
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 11 | Train Loss: 0.345 | Train Acc: 85.25% | Val. Loss: 0.347 | Val. Acc: 85.07% | Test Loss: 0.359 | Test Acc: 84.57% |
TEST ACCURACY: 84.57
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 12 | Train Loss: 0.321 | Train Acc: 86.74% | Val. Loss: 0.338 | Val. Acc: 85.37% | Test Loss: 0.355 | Test Acc: 85.05% |
TEST ACCURACY: 85.05
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 13 | Train Loss: 0.312 | Train Acc: 87.32% | Val. Loss: 0.346 | Val. Acc: 85.29% | Test Loss: 0.363 | Test Acc: 84.70% |
TEST ACCURACY: 85.05
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 14 | Train Loss: 0.303 | Train Acc: 87.72% | Val. Loss: 0.336 | Val. Acc: 85.69% | Test Loss: 0.355 | Test Acc: 84.82% |
TEST ACCURACY: 84.82
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 15 | Train Loss: 0.297 | Train Acc: 88.19% | Val. Loss: 0.358 | Val. Acc: 85.16% | Test Loss: 0.376 | Test Acc: 84.42% |
TEST ACCURACY: 84.82
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 16 | Train Loss: 0.290 | Train Acc: 88.26% | Val. Loss: 0.359 | Val. Acc: 85.67% | Test Loss: 0.377 | Test Acc: 84.88% |
TEST ACCURACY: 84.82
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 17 | Train Loss: 0.284 | Train Acc: 88.50% | Val. Loss: 0.342 | Val. Acc: 85.79% | Test Loss: 0.361 | Test Acc: 85.10% |
TEST ACCURACY: 85.1
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 18 | Train Loss: 0.277 | Train Acc: 88.94% | Val. Loss: 0.338 | Val. Acc: 85.72% | Test Loss: 0.354 | Test Acc: 85.21% |
TEST ACCURACY: 85.1
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 19 | Train Loss: 0.273 | Train Acc: 89.11% | Val. Loss: 0.330 | Val. Acc: 86.08% | Test Loss: 0.347 | Test Acc: 85.45% |
TEST ACCURACY: 85.45
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 20 | Train Loss: 0.262 | Train Acc: 89.76% | Val. Loss: 0.323 | Val. Acc: 86.48% | Test Loss: 0.338 | Test Acc: 85.82% |
TEST ACCURACY: 85.82
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 21 | Train Loss: 0.253 | Train Acc: 90.25% | Val. Loss: 0.374 | Val. Acc: 84.53% | Test Loss: 0.386 | Test Acc: 84.30% |
TEST ACCURACY: 85.82
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 22 | Train Loss: 10.895 | Train Acc: 90.32% | Val. Loss: 0.355 | Val. Acc: 85.44% | Test Loss: 0.363 | Test Acc: 85.04% |
TEST ACCURACY: 85.82
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 23 | Train Loss: 21.474 | Train Acc: 90.80% | Val. Loss: 0.334 | Val. Acc: 86.50% | Test Loss: 0.346 | Test Acc: 85.97% |
TEST ACCURACY: 85.97
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 24 | Train Loss: 31.927 | Train Acc: 90.66% | Val. Loss: 0.322 | Val. Acc: 86.94% | Test Loss: 0.334 | Test Acc: 86.66% |
TEST ACCURACY: 86.66
Ranks  [20, 20, 20, 20, 20, 20]
(0, 6371740)
Savings (0, 6371740) ratio 226.46850672328378
| Epoch: 25 | Train Loss: 41.869 | Train Acc: 90.24% | Val. Loss: 0.347 | Val. Acc: 85.63% | Test Loss: 0.360 | Test Acc: 85.42% |
TEST ACCURACY: 86.66
Ranks  [20, 20, 20, 20, 20, 19]
(168, 6371740)
Savings (168, 6371740) ratio 227.82286772034743
| Epoch: 26 | Train Loss: 49.979 | Train Acc: 89.60% | Val. Loss: 0.312 | Val. Acc: 87.01% | Test Loss: 0.326 | Test Acc: 86.55% |
TEST ACCURACY: 86.55
Ranks  [20, 20, 20, 15, 20, 14]
(3908, 6371740)
Savings (3908, 6371740) ratio 262.8120893561104
| Epoch: 27 | Train Loss: 57.638 | Train Acc: 89.11% | Val. Loss: 0.329 | Val. Acc: 86.18% | Test Loss: 0.342 | Test Acc: 85.90% |
TEST ACCURACY: 86.55
Ranks  [20, 20, 20, 14, 18, 10]
(5432, 6371740)
Savings (5432, 6371740) ratio 280.357455756089
| Epoch: 28 | Train Loss: 64.317 | Train Acc: 86.06% | Val. Loss: 0.396 | Val. Acc: 81.21% | Test Loss: 0.406 | Test Acc: 80.45% |
TEST ACCURACY: 86.55
Ranks  [20, 20, 20, 11, 15, 5]
(8160, 6371740)
Savings (8160, 6371740) ratio 318.40796019900495
| Epoch: 29 | Train Loss: 70.636 | Train Acc: 85.35% | Val. Loss: 0.408 | Val. Acc: 81.71% | Test Loss: 0.411 | Test Acc: 81.24% |
TEST ACCURACY: 86.55
Ranks  [20, 20, 20, 10, 12, 3]
(9168, 6371740)
Savings (9168, 6371740) ratio 335.21893987010264
| Epoch: 30 | Train Loss: 75.771 | Train Acc: 80.82% | Val. Loss: 0.502 | Val. Acc: 75.95% | Test Loss: 0.501 | Test Acc: 75.52% |
TEST ACCURACY: 86.55
Ranks  [20, 20, 20, 7, 9, 2]
(11048, 6371740)
Savings (11048, 6371740) ratio 371.8336044620033
| Epoch: 31 | Train Loss: 78.630 | Train Acc: 61.11% | Val. Loss: 0.654 | Val. Acc: 61.44% | Test Loss: 0.654 | Test Acc: 61.34% |
TEST ACCURACY: 86.55
Ranks  [19, 16, 16, 7, 7, 2]
(16209, 6371740)
Savings (16209, 6371740) ratio 531.076259231599
| Epoch: 32 | Train Loss: 78.243 | Train Acc: 53.98% | Val. Loss: 0.692 | Val. Acc: 53.71% | Test Loss: 0.691 | Test Acc: 54.24% |
TEST ACCURACY: 86.55
Ranks  [18, 8, 6, 5, 6, 2]
(24836, 6371740)
Savings (24836, 6371740) ratio 1869.1588785046729
| Epoch: 33 | Train Loss: 79.605 | Train Acc: 50.31% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [15, 4, 2, 5, 4, 2]
(27095, 6371740)
Savings (27095, 6371740) ratio 5493.562231759656
| Epoch: 34 | Train Loss: 81.915 | Train Acc: 49.83% | Val. Loss: 0.694 | Val. Acc: 49.99% | Test Loss: 0.694 | Test Acc: 50.01% |
TEST ACCURACY: 86.55
Ranks  [15, 1, 2, 3, 2, 2]
(27793, 6371740)
Savings (27793, 6371740) ratio 13704.496788008566
| Epoch: 35 | Train Loss: 84.154 | Train Acc: 49.96% | Val. Loss: 0.694 | Val. Acc: 50.01% | Test Loss: 0.694 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [14, 1, 0, 1, 0, 1]
(28070, 6371740)
Savings (28070, 6371740) ratio 33684.21052631579
| Epoch: 36 | Train Loss: 88.610 | Train Acc: 49.63% | Val. Loss: 0.694 | Val. Acc: 50.01% | Test Loss: 0.694 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [14, 0, 0, 1, 0, 1]
(28182, 6371740)
Savings (28182, 6371740) ratio 82051.28205128205
| Epoch: 37 | Train Loss: 93.320 | Train Acc: 50.28% | Val. Loss: 0.695 | Val. Acc: 50.01% | Test Loss: 0.695 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [11, 0, 0, 1, 0, 1]
(28197, 6371740)
Savings (28197, 6371740) ratio 101587.30158730158
| Epoch: 38 | Train Loss: 97.844 | Train Acc: 49.94% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [11, 0, 0, 0, 0, 1]
(28197, 6371740)
Savings (28197, 6371740) ratio 101587.30158730158
| Epoch: 39 | Train Loss: 102.771 | Train Acc: 50.39% | Val. Loss: 0.694 | Val. Acc: 50.01% | Test Loss: 0.694 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [10, 0, 0, 0, 0, 0]
(28210, 6371740)
Savings (28210, 6371740) ratio 128000.0
| Epoch: 40 | Train Loss: 107.869 | Train Acc: 49.90% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [10, 0, 0, 0, 0, 0]
(28210, 6371740)
Savings (28210, 6371740) ratio 128000.0
| Epoch: 41 | Train Loss: 113.126 | Train Acc: 50.00% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [9, 0, 0, 0, 0, 0]
(28215, 6371740)
Savings (28215, 6371740) ratio 142222.22222222222
| Epoch: 42 | Train Loss: 118.409 | Train Acc: 50.10% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [9, 0, 0, 0, 0, 0]
(28215, 6371740)
Savings (28215, 6371740) ratio 142222.22222222222
| Epoch: 43 | Train Loss: 123.718 | Train Acc: 49.69% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [8, 0, 0, 0, 0, 0]
(28220, 6371740)
Savings (28220, 6371740) ratio 160000.0
| Epoch: 44 | Train Loss: 129.031 | Train Acc: 49.54% | Val. Loss: 0.693 | Val. Acc: 49.99% | Test Loss: 0.693 | Test Acc: 50.01% |
TEST ACCURACY: 86.55
Ranks  [7, 0, 0, 0, 0, 0]
(28225, 6371740)
Savings (28225, 6371740) ratio 182857.14285714287
| Epoch: 45 | Train Loss: 134.365 | Train Acc: 49.85% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [6, 0, 0, 0, 0, 0]
(28230, 6371740)
Savings (28230, 6371740) ratio 213333.33333333334
| Epoch: 46 | Train Loss: 139.703 | Train Acc: 50.08% | Val. Loss: 0.693 | Val. Acc: 49.99% | Test Loss: 0.693 | Test Acc: 50.01% |
TEST ACCURACY: 86.55
Ranks  [5, 0, 0, 0, 0, 0]
(28235, 6371740)
Savings (28235, 6371740) ratio 256000.0
| Epoch: 47 | Train Loss: 145.041 | Train Acc: 50.20% | Val. Loss: 0.693 | Val. Acc: 49.99% | Test Loss: 0.693 | Test Acc: 50.01% |
TEST ACCURACY: 86.55
Ranks  [5, 0, 0, 0, 0, 0]
(28235, 6371740)
Savings (28235, 6371740) ratio 256000.0
| Epoch: 48 | Train Loss: 150.373 | Train Acc: 50.63% | Val. Loss: 0.694 | Val. Acc: 49.99% | Test Loss: 0.694 | Test Acc: 50.01% |
TEST ACCURACY: 86.55
Ranks  [2, 0, 0, 0, 0, 0]
(28250, 6371740)
Savings (28250, 6371740) ratio 640000.0
| Epoch: 49 | Train Loss: 155.741 | Train Acc: 50.23% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [2, 0, 0, 0, 0, 0]
(28250, 6371740)
Savings (28250, 6371740) ratio 640000.0
| Epoch: 50 | Train Loss: 161.099 | Train Acc: 50.19% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [1, 0, 0, 0, 0, 0]
(28255, 6371740)
Savings (28255, 6371740) ratio 1280000.0
| Epoch: 51 | Train Loss: 166.468 | Train Acc: 49.73% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [1, 0, 0, 0, 0, 0]
(28255, 6371740)
Savings (28255, 6371740) ratio 1280000.0
| Epoch: 52 | Train Loss: 171.853 | Train Acc: 49.56% | Val. Loss: 0.693 | Val. Acc: 49.99% | Test Loss: 0.693 | Test Acc: 50.01% |
TEST ACCURACY: 86.55
Ranks  [1, 0, 0, 0, 0, 0]
(28255, 6371740)
Savings (28255, 6371740) ratio 1280000.0
| Epoch: 53 | Train Loss: 177.231 | Train Acc: 49.90% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [1, 0, 0, 0, 0, 0]
(28255, 6371740)
Savings (28255, 6371740) ratio 1280000.0
| Epoch: 54 | Train Loss: 182.607 | Train Acc: 50.20% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [1, 0, 0, 0, 0, 0]
(28255, 6371740)
Savings (28255, 6371740) ratio 1280000.0
| Epoch: 55 | Train Loss: 187.978 | Train Acc: 50.02% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [0, 0, 0, 0, 0, 0]
(28260, 6371740)
Savings (28260, 6371740) ratio inf
| Epoch: 56 | Train Loss: 193.369 | Train Acc: 50.11% | Val. Loss: 0.693 | Val. Acc: 49.99% | Test Loss: 0.693 | Test Acc: 50.01% |
TEST ACCURACY: 86.55
Ranks  [0, 0, 0, 0, 0, 0]
(28260, 6371740)
Savings (28260, 6371740) ratio inf
| Epoch: 57 | Train Loss: 198.761 | Train Acc: 49.58% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [0, 0, 0, 0, 0, 0]
(28260, 6371740)
Savings (28260, 6371740) ratio inf
| Epoch: 58 | Train Loss: 204.148 | Train Acc: 50.12% | Val. Loss: 0.693 | Val. Acc: 50.01% | Test Loss: 0.693 | Test Acc: 49.99% |
TEST ACCURACY: 86.55
Ranks  [0, 0, 0, 0, 0, 0]
(28260, 6371740)
