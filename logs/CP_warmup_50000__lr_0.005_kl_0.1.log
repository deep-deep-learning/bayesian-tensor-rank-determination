run pytorch ...
Namespace(activation_function='relu', arch_embedding_size='4-3-2', arch_interaction_itself=False, arch_interaction_op='dot', arch_mlp_bot='13-512-256-256-128', arch_mlp_top='512-256-1', arch_sparse_feature_size=128, data_generation='dataset', data_randomize='total', data_set='kaggle', data_size=1, data_sub_sample_rate=0.0, data_trace_enable_padding=False, data_trace_file='./input/dist_emb_j.log', debug_mode=False, enable_profiling=False, inference_only=False, kl_multiplier=0.1, learning_rate=0.005, load_model='', load_saved=0, loss_function='bce', loss_threshold=0.0, loss_weights='1.0-1.0', lr_decay_start_step=0, lr_num_decay_steps=0, lr_num_warmup_steps=0, max_ind_range=-1, md_flag=False, md_round_dims=False, md_temperature=0.3, md_threshold=200, memory_map=True, mini_batch_size=512, mlperf_acc_threshold=0.0, mlperf_auc_threshold=0.0, mlperf_bin_loader=False, mlperf_bin_shuffle=False, mlperf_logging=False, nepochs=2, no_kl_steps=50000, num_batches=0, num_indices_per_lookup=10, num_indices_per_lookup_fixed=False, num_workers=0, numpy_rand_seed=123, optimizer='Adam', plot_compute_graph=False, print_freq=1024, print_precision=5, print_time=True, processed_data_file='./input/kaggleAdDisplayChallenge_processed.npz', qr_collisions=4, qr_flag=False, qr_operation='mult', qr_threshold=200, raw_data_file='./input/train.txt', round_targets=True, save_model='saved_models/CP_warmup_50000__lr_0.005_kl_0.1', save_onnx=False, sync_dense_params=True, tensor_type='CP', test_freq=10240, test_mini_batch_size=-1, test_num_workers=16, use_gpu=1)
Using 1 GPU(s)...
Reading pre-processed data=./input/kaggleAdDisplayChallenge_processed.npz
Sparse features= 26, Dense features= 13
Reading pre-processed data=./input/kaggleAdDisplayChallenge_processed.npz
Sparse features= 26, Dense features= 13
Embedding 0 size 1460x128
Embedding 1 size 583x128
Tensorized-Embedding 2 size 10131227x128
Tensorized-Embedding 3 size 2202608x128
Embedding 4 size 305x128
Embedding 5 size 24x128
Embedding 6 size 12517x128
Embedding 7 size 633x128
Embedding 8 size 3x128
Embedding 9 size 93145x128
Embedding 10 size 5683x128
Tensorized-Embedding 11 size 8351593x128
Embedding 12 size 3194x128
Embedding 13 size 27x128
Embedding 14 size 14992x128
Tensorized-Embedding 15 size 5461306x128
Embedding 16 size 10x128
Embedding 17 size 5652x128
Embedding 18 size 2173x128
Embedding 19 size 4x128
Tensorized-Embedding 20 size 7046547x128
Embedding 21 size 18x128
Embedding 22 size 15x128
Embedding 23 size 286181x128
Embedding 24 size 105x128
Embedding 25 size 142572x128
time/loss/accuracy (if enabled):
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Pruning tensor ranks
pruning with rank cutoff 1e-7 None
pruning with rank cutoff 1e-7 None
pruning with rank cutoff 1e-7 None
pruning with rank cutoff 1e-7 None
pruning with rank cutoff 1e-7 None
Finished training it 1024/76743 of epoch 0, 39.94 ms/it, loss 0.481441, accuracy 77.528 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  1023
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 2048/76743 of epoch 0, 40.11 ms/it, loss 0.466563, accuracy 78.264 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  2047
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 3072/76743 of epoch 0, 40.99 ms/it, loss 0.464517, accuracy 78.351 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  3071
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 4096/76743 of epoch 0, 40.71 ms/it, loss 0.462263, accuracy 78.484 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  4095
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 5120/76743 of epoch 0, 40.50 ms/it, loss 0.462915, accuracy 78.452 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  5119
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 6144/76743 of epoch 0, 40.57 ms/it, loss 0.460591, accuracy 78.528 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  6143
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 7168/76743 of epoch 0, 40.51 ms/it, loss 0.464785, accuracy 78.617 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  7167
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 8192/76743 of epoch 0, 40.50 ms/it, loss 0.464026, accuracy 78.543 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  8191
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 9216/76743 of epoch 0, 40.55 ms/it, loss 0.458897, accuracy 78.666 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  9215
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 10240/76743 of epoch 0, 40.64 ms/it, loss 0.460538, accuracy 78.741 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  10239
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Saving model to saved_models/CP_warmup_50000__lr_0.005_kl_0.1
Testing at - 10240/76743 of epoch 0, loss 0.462232, accuracy 78.297 %, best 0.000 %
Finished training it 11264/76743 of epoch 0, 40.61 ms/it, loss 0.460029, accuracy 78.800 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  11263
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 12288/76743 of epoch 0, 38.99 ms/it, loss 0.457903, accuracy 78.803 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  12287
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 13312/76743 of epoch 0, 38.52 ms/it, loss 0.462331, accuracy 78.690 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  13311
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 14336/76743 of epoch 0, 40.50 ms/it, loss 0.457529, accuracy 78.844 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  14335
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 15360/76743 of epoch 0, 40.59 ms/it, loss 0.456567, accuracy 78.847 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  15359
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 16384/76743 of epoch 0, 40.48 ms/it, loss 0.460558, accuracy 78.840 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  16383
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 17408/76743 of epoch 0, 40.63 ms/it, loss 0.468140, accuracy 78.640 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  17407
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 18432/76743 of epoch 0, 40.63 ms/it, loss 0.463881, accuracy 78.794 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  18431
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 19456/76743 of epoch 0, 40.60 ms/it, loss 0.464802, accuracy 78.717 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  19455
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 20480/76743 of epoch 0, 40.29 ms/it, loss 0.468849, accuracy 78.729 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  20479
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Saving model to saved_models/CP_warmup_50000__lr_0.005_kl_0.1
Testing at - 20480/76743 of epoch 0, loss 0.493883, accuracy 78.460 %, best 0.000 %
Finished training it 21504/76743 of epoch 0, 40.61 ms/it, loss 0.461355, accuracy 78.824 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  21503
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 22528/76743 of epoch 0, 38.70 ms/it, loss 0.460947, accuracy 78.709 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  22527
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 23552/76743 of epoch 0, 39.08 ms/it, loss 0.499368, accuracy 78.771 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  23551
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 24576/76743 of epoch 0, 40.50 ms/it, loss 0.457514, accuracy 78.831 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  24575
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 25600/76743 of epoch 0, 40.48 ms/it, loss 0.458134, accuracy 78.849 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  25599
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 26624/76743 of epoch 0, 40.45 ms/it, loss 0.472569, accuracy 78.828 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  26623
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 27648/76743 of epoch 0, 40.42 ms/it, loss 0.467950, accuracy 78.716 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  27647
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 28672/76743 of epoch 0, 40.41 ms/it, loss 0.484506, accuracy 78.663 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  28671
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 29696/76743 of epoch 0, 40.55 ms/it, loss 0.491093, accuracy 78.783 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  29695
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 30720/76743 of epoch 0, 40.53 ms/it, loss 0.497692, accuracy 78.698 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  30719
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Saving model to saved_models/CP_warmup_50000__lr_0.005_kl_0.1
Testing at - 30720/76743 of epoch 0, loss 0.469381, accuracy 78.296 %, best 0.000 %
Finished training it 31744/76743 of epoch 0, 40.53 ms/it, loss 0.470209, accuracy 78.639 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  31743
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 32768/76743 of epoch 0, 38.54 ms/it, loss 0.463164, accuracy 78.715 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  32767
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 33792/76743 of epoch 0, 39.38 ms/it, loss 0.507220, accuracy 78.741 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  33791
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 34816/76743 of epoch 0, 40.55 ms/it, loss 0.516444, accuracy 78.759 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  34815
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 35840/76743 of epoch 0, 40.46 ms/it, loss 0.522870, accuracy 78.947 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  35839
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 36864/76743 of epoch 0, 40.42 ms/it, loss 0.517855, accuracy 78.645 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  36863
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 37888/76743 of epoch 0, 40.49 ms/it, loss 0.515656, accuracy 78.696 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  37887
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 38912/76743 of epoch 0, 40.66 ms/it, loss 0.530865, accuracy 78.856 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  38911
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 39936/76743 of epoch 0, 40.48 ms/it, loss 0.515276, accuracy 78.842 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  39935
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Finished training it 40960/76743 of epoch 0, 40.71 ms/it, loss 0.509248, accuracy 78.599 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  40959
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Tensor type  CP  rank  350
Saving model to saved_models/CP_warmup_50000__lr_0.005_kl_0.1
done
