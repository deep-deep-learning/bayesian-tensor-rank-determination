Namespace(activation_function='relu', arch_embedding_size='4-3-2', arch_interaction_itself=False, arch_interaction_op='dot', arch_mlp_bot='13-512-256-64-16', arch_mlp_top='512-256-1', arch_sparse_feature_size=16, data_generation='dataset', data_randomize='total', data_set='kaggle', data_size=1, data_sub_sample_rate=0.0, data_trace_enable_padding=False, data_trace_file='./input/dist_emb_j.log', debug_mode=False, enable_profiling=False, inference_only=False, kl_multiplier=1.0, learning_rate=0.005, load_model='', load_saved=0, loss_function='bce', loss_threshold=0.0, loss_weights='1.0-1.0', lr_decay_start_step=0, lr_num_decay_steps=0, lr_num_warmup_steps=0, max_ind_range=-1, md_flag=False, md_round_dims=False, md_temperature=0.3, md_threshold=200, memory_map=True, mini_batch_size=128, mlperf_acc_threshold=0.0, mlperf_auc_threshold=0.0, mlperf_bin_loader=False, mlperf_bin_shuffle=False, mlperf_logging=False, nepochs=1, no_kl_steps=50000, num_batches=0, num_indices_per_lookup=10, num_indices_per_lookup_fixed=False, num_workers=0, numpy_rand_seed=123, optimizer='Adam', plot_compute_graph=False, print_freq=1024, print_precision=5, print_time=True, processed_data_file='./input/kaggleAdDisplayChallenge_processed.npz', qr_collisions=4, qr_flag=False, qr_operation='mult', qr_threshold=200, raw_data_file='./input/train.txt', round_targets=True, save_model='saved_models/Tucker_warmup_50000_Adam_0.005', save_onnx=False, sync_dense_params=True, tensor_type='Tucker', test_freq=10240, test_mini_batch_size=-1, test_num_workers=16, use_gpu=1)
Using 1 GPU(s)...
Reading pre-processed data=./input/kaggleAdDisplayChallenge_processed.npz
Sparse features= 26, Dense features= 13
Reading pre-processed data=./input/kaggleAdDisplayChallenge_processed.npz
Sparse features= 26, Dense features= 13
Embedding 0 size 1460x16
Embedding 1 size 583x16
TT-Embedding 2 size 10131227x16
Embedding 3 size 2202608x16
Embedding 4 size 305x16
Embedding 5 size 24x16
Embedding 6 size 12517x16
Embedding 7 size 633x16
Embedding 8 size 3x16
Embedding 9 size 93145x16
Embedding 10 size 5683x16
Embedding 11 size 8351593x16
Embedding 12 size 3194x16
Embedding 13 size 27x16
Embedding 14 size 14992x16
Embedding 15 size 5461306x16
Embedding 16 size 10x16
Embedding 17 size 5652x16
Embedding 18 size 2173x16
Embedding 19 size 4x16
Embedding 20 size 7046547x16
Embedding 21 size 18x16
Embedding 22 size 15x16
Embedding 23 size 286181x16
Embedding 24 size 105x16
Embedding 25 size 142572x16
time/loss/accuracy (if enabled):
Finished training it 1024/306969 of epoch 0, 35.34 ms/it, loss 0.493449, accuracy 76.926 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  1023
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 2048/306969 of epoch 0, 35.01 ms/it, loss 0.480758, accuracy 77.564 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  2047
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 3072/306969 of epoch 0, 34.28 ms/it, loss 0.478719, accuracy 77.692 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  3071
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 4096/306969 of epoch 0, 34.13 ms/it, loss 0.475124, accuracy 77.777 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  4095
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 5120/306969 of epoch 0, 34.08 ms/it, loss 0.470367, accuracy 78.097 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  5119
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 6144/306969 of epoch 0, 34.14 ms/it, loss 0.469261, accuracy 78.083 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  6143
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 7168/306969 of epoch 0, 34.09 ms/it, loss 0.466831, accuracy 78.275 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  7167
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 8192/306969 of epoch 0, 34.19 ms/it, loss 0.465613, accuracy 78.268 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  8191
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 9216/306969 of epoch 0, 34.06 ms/it, loss 0.467119, accuracy 78.278 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  9215
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 10240/306969 of epoch 0, 34.07 ms/it, loss 0.464795, accuracy 78.320 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  10239
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Saving model to saved_models/Tucker_warmup_50000_Adam_0.005
Testing at - 10240/306969 of epoch 0, loss 0.469596, accuracy 77.910 %, best 0.000 %
Finished training it 11264/306969 of epoch 0, 44.13 ms/it, loss 0.463192, accuracy 78.455 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  11263
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 12288/306969 of epoch 0, 44.09 ms/it, loss 0.464588, accuracy 78.328 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  12287
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 13312/306969 of epoch 0, 44.07 ms/it, loss 0.462397, accuracy 78.467 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  13311
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 14336/306969 of epoch 0, 44.12 ms/it, loss 0.460162, accuracy 78.605 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  14335
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 15360/306969 of epoch 0, 43.92 ms/it, loss 0.466184, accuracy 78.493 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  15359
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 16384/306969 of epoch 0, 43.98 ms/it, loss 0.464281, accuracy 78.349 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  16383
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 17408/306969 of epoch 0, 44.27 ms/it, loss 0.461341, accuracy 78.557 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  17407
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 18432/306969 of epoch 0, 44.06 ms/it, loss 0.462131, accuracy 78.404 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  18431
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 19456/306969 of epoch 0, 44.01 ms/it, loss 0.461994, accuracy 78.400 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  19455
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Finished training it 20480/306969 of epoch 0, 44.01 ms/it, loss 0.462931, accuracy 78.507 %
KL loss  0.0 iteration kl_multiplier  0.0  iter  20479
Tensor type  tucker
Tensor layer rank 1e-6 [21, 21, 21, 21]
Tensor layer rank 1e-8 [21, 21, 21, 21]
Tensor layer rank 1e-10 [21, 21, 21, 21]
Saving model to saved_models/Tucker_warmup_50000_Adam_0.005
